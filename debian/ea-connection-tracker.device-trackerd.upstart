description "DHCP fingerprinter and Host gatherer"

start on started access-control
stop on stopping access-control

respawn
respawn limit 10 5

env PYTHONPATH=/origin/lib/python
env DEVICE_NFLOG_QUEUE=10

exec /origin/bin/device-trackerd


pre-start script
  nft create chain bridge origin device-tracker '{type filter hook forward priority -210; iifname != "eth0" log group '$DEVICE_NFLOG_QUEUE'; }' || true
end script

post-stop script
  nft flush chain bridge origin device-tracker
  nft delete chain bridge origin device-tracker
end script
