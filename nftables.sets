#!/usr/sbin/nft -f

table bridge elan {
  set ndp_pt_ifs {
    type iface_index . iface_index ;
  }
  set dhcp_pt_ifs {
    type iface_index . iface_index ;
  }
  set dns_pt_ifs {
    type iface_index . iface_index ;
  }
  set mdns_pt_ifs {
    type iface_index . iface_index ;
  }
  set ac_ifs {
    type iface_index ;
  }
  set log_ifs {
    type iface_index ;
  }
  set ids_ifs {
    type iface_index ;
  }
  set mac_on_vlan {
    type ether_addr . iface_index ;
  }
  set mac_to_vlan {
    type ether_addr . iface_index ;
  }
  set ip_conn2mark {
  	type ipv4_addr . inet_service . ipv4_addr . inet_service ;
  }
  set ip6_conn2mark {
  	type ipv6_addr . inet_service . ipv6_addr . inet_service ;
  }
  
  map vlan_mark {
    type iface_index : mark ;
  }
}

table ip elan {
  map captive_portals {
    type mark . inet_service : inet_service ;
  }
}

table ip6 elan {
  map captive_portals {
    type mark . inet_service : inet_service ;
  }
}
